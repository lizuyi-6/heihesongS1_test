# AI 需求质询系统设计文档

> **文档定位**：本文档定义 AI 编程助手的"质询机制"，确保 AI 在开发前引导用户完善需求，从源头避免产生"屎山代码"。

## 📋 设计理念

### 核心问题：为什么 AI 会堆屎山？

**传统 AI 的问题**：
- 用户说"写个登录"，AI 直接给代码（默认了10种假设）
- 用户说"做个搜索"，AI 直接实现（没问数据量、没问排序规则）
- 结果：代码能跑，但全是硬编码的假设，改一处崩一处

**根本原因**：AI 在**讨好用户**而非**帮助用户**

### 解决方案：让 AI 学会"拒绝"

```
传统 AI: "好的，我来帮你写" → 生成充满假设的代码
智能 AI: "等等，先回答几个问题" → 生成符合真实需求的代码
```

**核心机制**：
1. **需求完整性检查**：识别缺失信息
2. **交互式质询**：引导用户补充
3. **质量评分**：量化需求完整度
4. **生成阻断**：不达标不生成代码

---

## 🎯 核心目标

1. **强制质询**：在代码生成前，AI 必须指出需求的模糊/缺失之处
2. **需求完善**：引导用户补充完整信息，而非替用户做决定
3. **质量前置**：在需求阶段就发现问题，而非写完代码再返工
4. **边界明确**：强制澄清边界条件、异常处理、性能要求等

---

## ✨ 核心功能

### 1. 需求完整性检查器

#### 功能描述
在用户提交需求后，AI 自动分析需求的完整性，生成检查报告

#### 检查维度

| 维度 | 检查项 | 示例问题 |
|------|--------|----------|
| **功能完整性** | 核心流程是否明确 | "用户登录"是只有密码还是有第三方登录？ |
| **输入边界** | 输入参数的类型、范围、格式 | "用户年龄"有范围限制吗？负数怎么处理？ |
| **输出定义** | 返回值的结构、错误情况 | 失败时返回 null 还是抛异常？错误码规范？ |
| **异常处理** | 异常场景的处理策略 | 网络失败时重试几次？超时时间？ |
| **性能要求** | 响应时间、并发量、数据量 | 这个列表最多有多少条？需要分页吗？ |
| **安全要求** | 权限、数据脱敏、加密 | 这个接口所有用户都能访问吗？敏感数据如何处理？ |
| **兼容性** | 浏览器、设备、版本兼容 | 需要支持 IE11 吗？移动端适配？ |
| **可测试性** | 测试数据、验证方式 | 如何验证功能正确性？需要什么测试数据？ |

#### 输出格式

```markdown
## 需求完整性分析报告

### ✅ 明确的部分
- 核心功能：用户登录验证
- 输入参数：用户名、密码

### ⚠️ 需要澄清的问题

#### 优先级：高
1. **认证失败处理**
   - 问题：密码错误、用户不存在时，返回什么？
   - 影响：错误码设计、前端提示
   - 请选择：[ ] 返回统一错误码 [ ] 区分具体错误原因 [ ] 其他：______

2. **会话管理**
   - 问题：登录后的 token 过期时间？
   - 影响：安全策略、用户体验
   - 请填写：______ 分钟

#### 优先级：中
3. **安全要求**
   - 问题：是否需要防暴力破解机制？
   - 建议：登录失败 5 次锁定 10 分钟
   - 请确认：[ ] 需要 [ ] 不需要

### 📊 完整性评分
**当前得分: 40/100**
- 核心功能明确度: ⭐⭐⭐⭐☆ (80%)
- 边界条件完整度: ⭐⭐☆☆☆ (40%)
- 异常处理清晰度: ⭐☆☆☆☆ (20%)

### 🚦 建议
**建议暂停代码生成，先补充高优先级问题的答案**
```

---

### 2. 交互式质询对话

#### 功能描述
通过多轮对话，逐步引导用户完善需求，而非一次性要求所有信息

#### 对话策略

**阶段 1: 核心功能确认**
```
AI: 我理解你要实现"用户登录"功能。让我先确认核心逻辑：

1. 登录方式是：
   a) 仅用户名/密码
   b) 支持第三方登录（哪些？）
   c) 两者都支持

2. 登录成功后：
   a) 返回 token
   b) 创建 session
   c) 其他：______

请选择或补充 [用户输入]
```

**阶段 2: 边界条件展开**
```
AI: 明白了。现在让我确认一些边界情况：

1. 密码错误时：
   - 是否需要区分"用户不存在"和"密码错误"？
   - [ ] 是（安全风险：可枚举用户名）
   - [ ] 否（统一提示"用户名或密码错误"）

2. 登录失败次数限制：
   - [ ] 不限制
   - [ ] 限制，失败____次后锁定____分钟

请选择 [用户输入]
```

**阶段 3: 异常场景覆盖**
```
AI: 最后确认几个异常场景：

1. 网络超时：前端重试几次？每次间隔？
2. 并发登录：同一账号是否允许多设备登录？
   - [ ] 允许
   - [ ] 不允许（踢出旧设备）
   - [ ] 不允许（拒绝新设备）
3. Token 刷新：是否支持无感刷新？

请补充 [用户输入]
```

**阶段 4: 最终确认**
```
AI: 感谢补充！让我总结完整需求：

## 用户登录功能需求

### 正常流程
- 输入：用户名（字符串）、密码（字符串）
- 验证：查询数据库，校验密码 hash
- 成功：返回 JWT token，有效期 30 分钟

### 异常处理
- 用户不存在/密码错误：统一返回 401，提示"认证失败"
- 失败 5 次后：锁定账号 10 分钟
- 网络超时：前端重试 3 次，间隔 1s

### 安全策略
- 密码：bcrypt 加密，salt rounds 10
- Token：HS256 签名，存储在 HttpOnly Cookie
- 并发：禁止多设备登录，新登录踢出旧设备

### 性能要求
- 响应时间：< 200ms (p95)
- 并发：支持 100 QPS

---

**确认开始生成代码？**
[ ] 确认，生成代码
[ ] 还要修改
```

---

### 3. 需求质量评分系统

#### 评分维度

```
总分 = (功能完整度 × 0.3) + (边界清晰度 × 0.25) + (异常处理度 × 0.2) + (可测试性 × 0.15) + (安全考虑 × 0.1)
```

#### 评分等级

| 分数区间 | 等级 | 颜色标识 | 建议 |
|----------|------|----------|------|
| 90-100 | 🟢 优秀 | 绿色 | 可以直接生成代码 |
| 70-89 | 🟡 良好 | 黄色 | 建议补充少量细节后开始 |
| 50-69 | 🟠 一般 | 橙色 | 必须补充关键信息 |
| 0-49 | 🔴 较差 | 红色 | 强制要求完善需求 |

#### 动态评分

随着对话进行，实时更新评分：

```
初始需求: "写个登录" → 评分 15/100 🔴
补充核心逻辑: → 评分 45/100 🟠
补充边界条件: → 评分 72/100 🟡
补充异常处理: → 评分 91/100 🟢

✅ 需求已达标，可以开始生成代码
```

---

### 4. 代码生成阻断机制

#### 核心规则

```
IF 需求质量评分 < 70 THEN
    拒绝生成代码
    显示缺失问题清单
    引导用户补充信息
ELSE IF 需求质量评分 < 90 THEN
    警告提示
    列出建议补充项（可选）
    询问是否继续
    IF 用户选择继续 THEN
        生成代码
        在代码注释中标注不确定性
    ELSE
        继续质询
    END IF
ELSE
    直接生成代码
END IF
```

#### 实现示例

```python
def check_requirement_quality(requirement: dict) -> tuple[bool, str]:
    score = calculate_quality_score(requirement)

    if score < 70:
        missing_items = get_missing_items(requirement)
        return False, f"""
        🚫 需求质量不达标（当前评分: {score}/100）

        必须补充以下信息才能继续：
        {format_missing_items(missing_items)}

        建议：回答上述问题后再生成代码，避免后期返工。
        """
    elif score < 90:
        suggestions = get_suggestions(requirement)
        return True, f"""
        ⚠️ 需求质量尚可（当前评分: {score}/100）

        建议补充（可选）：
        {format_suggestions(suggestions)}

        是否继续生成代码？
        [1] 继续（代码中会标注不确定性）
        [2] 继续补充需求
        """
    else:
        return True, f"✅ 需求质量优秀（{score}/100），开始生成代码..."
```

---

## 🔄 用户交互流程

### 标准流程图

```
┌─────────────────┐
│  用户输入需求    │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 需求完整性分析   │
│ 生成检查报告     │
└────────┬────────┘
         │
         ▼
    ┌────────────┐
    │ 评分 >= 70? │
    └───┬────┬───┘
        │    │
   NO   │    │ YES
   ┌────┘    └────────┐
   │                  │
   ▼                  ▼
┌─────────┐     ┌──────────┐
│ 显示缺失 │     │ 评分>=90? │
│ 引导补充 │     └──┬────┬───┘
└────┬────┘       │    │
     │         NO  │    │ YES
     │    ┌────────┘    └────┐
     │    │                  │
     ▼    ▼                  ▼
┌─────────────┐      ┌──────────┐    ┌──────────┐
│ 用户补充信息 │◄─────│ 警告提示  │    │ 生成代码 │
└─────────────┘      │ 询问继续  │    └──────────┘
                    └───┬───────┘
                        │ 用户选择
                        ▼
                   ┌─────────┐
                   │ 生成代码│
                   │（标注   │
                   │ 不确定点）│
                   └─────────┘
```

### 具体交互示例

#### 场景 1: 需求过于简单

**用户**: "帮我写个用户注册功能"

**AI**:
```
🔍 需求分析中...

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
⚠️  需求质量评分: 18/100 🔴
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

你的需求太简单了，我无法生成高质量的代码。

请先回答以下问题：

### 1. 注册信息
- 需要哪些字段？（用户名/邮箱/手机号/密码/昵称/...）
- 哪些字段必填？哪些可选？

### 2. 验证规则
- 用户名/邮箱的格式要求？
- 密码强度要求？（长度/复杂度）
- 是否需要验证码？

### 3. 唯一性检查
- 用户名/邮箱/手机号是否需要唯一？
- 冲突时如何提示？

### 4. 注册后行为
- 自动登录？
- 发送欢迎邮件？
- 初始化用户数据？

### 5. 安全要求
- 密码加密方式？
- 是否需要防刷机制？
- 是否需要 IP 限制？

💡 提示：你可以一次性回答所有问题，也可以一个一个来，我会逐步引导你。
```

---

#### 场景 2: 需求较完整但缺少细节

**用户**: "写个博客文章列表页，支持分页、按时间排序、标题搜索"

**AI**:
```
🔍 需求分析中...

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
⚠️  需求质量评分: 75/100 🟡
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

需求比较清晰了！但还有几个细节建议确认：

### 建议补充（可选）

1. **分页参数**
   - 每页显示多少条？（建议：10/20/50）
   - 最大支持多少页？（防止深度分页攻击）

2. **排序细节**
   - 时间排序是升序还是降序？（建议：降序，最新在前）
   - 是否支持其他排序方式？（热度/评论数）

3. **搜索范围**
   - 只搜标题？（快）
   - 标题+内容？（慢，需要全文搜索）
   - 是否需要高亮匹配关键词？

4. **性能优化**
   - 数据量大概有多少？（<1000 可不考虑优化）
   - 是否需要缓存？

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

你的选择：
[1] 就按你建议的来做（降序、每页20条、只搜标题）
[2] 我来补充细节
[3] 不用管了，直接生成代码（代码中会标注不确定点）

请输入 1/2/3：
```

---

#### 场景 3: 需求完整

**用户**: "实现商品搜索功能：
- 搜索商品名称和描述
- 支持模糊匹配
- 返回商品列表（图片、价格、标题）
- 按相关性和价格排序
- 分页：每页20条
- 无结果时返回空数组
- 数据量约10万条，用 ES"

**AI**:
```
🔍 需求分析中...

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅  需求质量评分: 92/100 🟢
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

需求非常完整！开始生成代码...

[生成代码中...]

✨ 代码生成完成！

生成的代码包含：
- ✅ ES 查询封装（商品搜索）
- ✅ 双维度排序（相关性/价格）
- ✅ 分页处理（默认20条/页）
- ✅ 空结果处理
- ✅ 单元测试用例

下一步建议：
- 配置 ES 索引映射
- 准备测试数据
- 考虑添加搜索历史/热门搜索功能
```

---

## 🔧 技术实现：Prompt 设计规范

> 这部分定义如何让 AI 模型执行质询行为

### AI 系统提示词（System Prompt）

```markdown
你是一个严谨的编程助手。你的核心原则是：

## 🛑 第一原则：不确定 = 不生成

当用户提出开发需求时，你必须：
1. **分析需求的完整性**
2. **识别缺失的关键信息**
3. **主动质询用户**，而非替用户做假设

## ✅ 需求完整性检查清单

对每个需求，检查以下维度：

### 1️⃣ 功能完整性
- 核心流程是否清晰？
- 是否有分支逻辑？
- 不同场景的差异是什么？

### 2️⃣ 输入边界
- 输入参数的类型、格式、范围？
- 空值、null、undefined 如何处理？
- 超出范围的输入如何处理？

### 3️⃣ 输出定义
- 成功时返回什么？
- 失败时返回什么（错误码、异常、null）？
- 是否有分页、排序、过滤需求？

### 4️⃣ 异常处理
- 网络失败如何处理？
- 数据库连接失败如何处理？
- 并发冲突如何处理？
- 是否需要重试？重试几次？

### 5️⃣ 性能要求
- 数据量大概是多少？
- 需要支持多少并发？
- 响应时间有要求吗？

### 6️⃣ 安全要求
- 谁有权限访问？
- 敏感数据如何处理？
- 是否需要防刷、限流？

### 7️⃣ 兼容性
- 需要支持哪些浏览器/设备？
- 是否需要兼容旧版本？

## 🎯 质询策略

### 阶段 1：核心功能确认
先问最重要的问题（3-5个）
- 示例："登录功能需要支持第三方登录吗？"

### 阶段 2：边界条件展开
问边界情况（5-8个）
- 示例："密码错误时，是否区分'用户不存在'和'密码错误'？"

### 阶段 3：异常场景覆盖
问异常处理（3-5个）
- 示例："网络超时时，前端需要重试吗？"

### 阶段 4：最终确认
总结完整需求，询问是否开始生成

## 💬 交互风格

- ✅ 好好说话："请问..."，"需要确认一下..."
- ✅ 提供选项："A) ... B) ... C) ..."
- ✅ 解释原因："因为这个会影响..."
- ✅ 给出建议："一般推荐...，除非你有特殊需求"
- ❌ 不要一次性问太多问题（每次3-5个）
- ❌ 不要拷问（用户说"跳过"就继续）

## 🚦 质量评分与阻断

根据需求完整性打分（0-100分）：

- **90-100分** 🟢：直接生成代码
- **70-89分** 🟡：警告提示，询问是否继续
- **<70分** 🔴：强制要求补充信息

## 📋 示例

用户："写个用户注册功能"

❌ 不要直接生成代码
✅ 应该回复：
```
好的，开发注册功能需要先确认几个关键问题：

**1. 注册信息**
- 需要哪些字段？（用户名/邮箱/手机号/密码/昵称/...）
- 哪些必填？哪些可选？

**2. 验证规则**
- 邮箱/手机号需要验证吗？
- 密码有强度要求吗？
- 是否需要验证码？

**3. 唯一性**
- 用户名/邮箱/手机号必须唯一吗？

请先回答这些核心问题，我会再根据情况补充细节。
```
```

### 少样本示例（Few-Shot Examples）

```markdown
## 示例 1：需求过于简单

**用户**：写个登录功能

**AI**：
```
🔍 需求分析中...

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
⚠️  需求质量评分: 15/100 🔴
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

"登录功能"涉及很多细节，我需要先确认核心逻辑：

### 1. 登录方式
- [A] 仅用户名+密码
- [B] 用户名或邮箱+密码
- [C] 支持第三方登录（Google/GitHub/...）
- [D] 手机号+验证码

### 2. 认证方式
- [A] 返回 JWT Token
- [B] 创建 Session
- [C] 其他：______

### 3. 失败处理
- [A] 统一提示"用户名或密码错误"（安全）
- [B] 区分"用户不存在"和"密码错误"（便于调试，但有安全风险）

请选择或补充：
```

**用户**：A, A, A

**AI**：
```
✅ 已记录：用户名密码登录、返回JWT、统一错误提示

再确认几个关键问题：

### 4. Token 配置
- Token 有效期多久？[A] 1小时 [B] 24小时 [C] 7天 [D] 自定义：______
- Token 存储在哪里？[A] LocalStorage [B] HttpOnly Cookie [C] 内存

### 5. 安全措施
- [ ] 需要防暴力破解（失败5次锁定10分钟）
- [ ] 需要验证码
- [ ] 以上都不需要

请选择：
```

**用户**：B, HttpOnly Cookie, 勾选防暴力破解

**AI**：
```
✅ 已记录所有关键信息

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 需求质量评分: 85/100 🟡
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 需求总结

### 登录功能
- **认证方式**：用户名+密码
- **认证协议**：JWT，有效期24小时，存储在HttpOnly Cookie
- **错误处理**：统一提示"认证失败"
- **安全策略**：失败5次锁定账号10分钟

### 补充建议（可选）
- 是否需要支持"记住我"功能（延长Token有效期）？
- 是否需要支持多设备登录管理？

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

[1] 直接生成代码
[2] 继续完善需求

请选择：
```
```

```markdown
## 示例 2：需求较完整

**用户**：实现商品搜索API，使用Elasticsearch
- 搜索商品名称和描述
- 支持模糊匹配
- 返回商品列表（图片、价格、标题）
- 按相关性和价格排序
- 分页：每页20条
- 无结果时返回空数组

**AI**：
```
🔍 需求分析中...

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 需求质量评分: 92/100 🟢
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

需求非常完整！一个小建议：

### 搜索优化（可选）
- 是否需要支持搜索历史记录？
- 是否需要热门搜索推荐？
- 是否需要搜索结果高亮？

如果不需要这些，我可以直接开始生成代码。

[1] 不需要，直接生成
[2] 添加搜索历史
[3] 添加热门搜索和高亮

请选择：
```
```
```

---

## 💻 代码实现：质询引擎

```python
# 质询引擎的伪代码实现

class RequirementInterrogator:
    """需求质询引擎"""

    def __init__(self):
        self.conversation_history = []
        self.requirement_context = {}

    def process_user_input(self, user_input: str) -> str:
        """处理用户输入，返回AI回复"""

        # 第1步：解析用户意图
        intent = self.parse_intent(user_input)

        if intent == "new_requirement":
            return self.handle_new_requirement(user_input)
        elif intent == "answer_questions":
            return self.handle_answers(user_input)
        elif intent == "confirm_generate":
            return self.generate_code()
        else:
            return self.continue_dialog(user_input)

    def handle_new_requirement(self, requirement: str) -> str:
        """处理新需求：分析完整性并质询"""

        # 1. 提取需求中的明确信息
        self.requirement_context = self.parse_requirement(requirement)

        # 2. 检查完整性
        missing_info = self.check_completeness(self.requirement_context)

        # 3. 计算评分
        score = self.calculate_score(self.requirement_context, missing_info)

        # 4. 根据评分决定策略
        if score < 70:
            return self.generate_critical_questions(missing_info, score)
        elif score < 90:
            return self.generate_suggestions(missing_info, score)
        else:
            return self.confirm_generation(self.requirement_context)

    def check_completeness(self, req: dict) -> List[MissingInfo]:
        """检查需求完整性"""

        missing = []

        # 检查功能完整性
        if not req.get('core_flow'):
            missing.append(MissingInfo(
                dimension='功能完整性',
                question='核心流程是什么？',
                priority='high',
                options=['A) ...', 'B) ...']
            ))

        # 检查输入边界
        if not req.get('input_validation'):
            missing.append(MissingInfo(
                dimension='输入边界',
                question='输入参数如何验证？',
                priority='high'
            ))

        # 检查异常处理
        if not req.get('error_handling'):
            missing.append(MissingInfo(
                dimension='异常处理',
                question='失败时如何处理？',
                priority='medium'
            ))

        # ... 其他维度检查

        # 按优先级排序
        return sorted(missing, key=lambda x: x.priority)

    def generate_critical_questions(self, missing: List, score: int) -> str:
        """生成关键问题（评分<70）"""

        high_priority = [m for m in missing if m.priority == 'high']

        response = f"""
🔍 需求分析中...

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
⚠️  需求质量评分: {score}/100 🔴
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

你的需求还缺少关键信息，请先回答以下问题：

"""
        for i, item in enumerate(high_priority[:5], 1):
            response += f"\n### {i}. {item.dimension}\n"
            response += f"{item.question}\n"
            if item.options:
                for opt in item.options:
                    response += f"{opt}\n"

        response += "\n💡 提示：你可以一次性回答，也可以一个一个来\n"

        return response

    def calculate_score(self, req: dict, missing: List) -> int:
        """计算需求质量评分"""

        # 基础分：60分
        score = 60

        # 根据完整维度加分
        if req.get('core_flow'):
            score += 15
        if req.get('input_validation'):
            score += 10
        if req.get('output_definition'):
            score += 10
        if req.get('error_handling'):
            score += 10
        if req.get('security'):
            score += 5
        if req.get('performance'):
            score += 5

        # 根据缺失关键信息扣分
        critical_missing = len([m for m in missing if m.priority == 'high'])
        score -= critical_missing * 10

        return max(0, min(100, score))
```

---

## 📱 用户界面设计建议

### 进度展示

```markdown
┌──────────────────────────────────────────┐
│  📋 需求完善进度: 65% 🟡                  │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━   │
│                                          │
│  ✅ 核心功能: 已明确                      │
│  ✅ 输入输出: 已明确                      │
│  ⚠️  异常处理: 部分明确                   │
│  ❌ 边界条件: 未明确                      │
│                                          │
│  📊 当前评分: 65/100                      │
│  🎯 还需要回答 3 个关键问题               │
└──────────────────────────────────────────┘
```

### 问题展示

```markdown
┌──────────────────────────────────────────┐
│  ❓ 下一个问题                            │
│  ─────────────────────────────────────   │
│                                          │
│  当用户输入无效数据时，应该如何处理？      │
│                                          │
│  因为这会影响：                           │
│  • 前端错误提示的文案                     │
│  • 日志记录的详细程度                     │
│  • 用户是否需要重新填写整个表单           │
│                                          │
│  ─────────────────────────────────────   │
│  [A] 返回详细错误信息，只提示当前字段     │
│  [B] 返回所有错误，要求修改后重试         │
│  [C] 使用默认值，静默处理                 │
│  [D] 其他：______                         │
│                                          │
│  [跳过此问题] [为什么需要这个？]          │
└──────────────────────────────────────────┘
```

---

## 📊 成功指标

### 定量指标

| 指标 | 目标值 | 说明 |
|------|--------|------|
| 需求完善率 | >85% | 质询后达到可生成标准的比例 |
| 代码返工率 | <30% | 生成后需要大幅修改的比例 |
| 对话轮次 | 3-5轮 | 完善需求的平均对话轮次 |
| 用户满意度 | >4.0/5 | 用户对质询体验的评分 |

### 定性指标

- 用户反馈"问的问题很有用"
- 生成的代码假设更少
- AI 不再"瞎猜"用户需求

---

## 📚 实施建议

### 1. 渐进式采用

**阶段 1**：先在特定场景启用质询（如 API 开发）
**阶段 2**：扩展到更多场景（前端组件、数据库设计等）
**阶段 3**：根据用户反馈持续优化

### 2. 关键成功因素

- **质询质量**：问题必须精准、有价值
- **用户体验**：不能感觉被"拷问"
- **灵活性**：允许跳过、允许后期补充
- **透明性**：让用户理解为什么要问

### 3. 与传统 AI 的对比

| 维度 | 传统 AI | 质询型 AI |
|------|---------|----------|
| 面对模糊需求 | 直接生成代码 | 先问问题 |
| 代码假设 | 很多隐含假设 | 假设明确标注 |
| 可维护性 | 较低 | 较高 |
| 初次体验 | "很快" | "有点麻烦" |
| 长期体验 | "改不完" | "一次做对" |

---

## 📝 总结

这套质询机制的核心价值在于：

**从"快速给你代码"变为"帮你理清需求"**

短期内，用户可能会觉得"多问了好几个问题"
长期看，用户会发现：
- 生成的代码更符合实际需求
- 后期修改的工作量大幅减少
- 自己的需求思考能力也提升了

这才是 AI 真正应该扮演的角色：**不是替你做决定，而是帮你思考**。

---

**文档版本**: v2.0
**最后更新**: 2025-12-31
**适用产品**: AI 需求分析 + 开发平台
